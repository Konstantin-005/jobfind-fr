## [2025-11-23] - Пагинация списка вакансий на /vacancy
### Изменено
- UX пагинации дополнен: при смене страницы список плавно скроллится к началу, добавлен текстовый индикатор диапазона "Показаны X–Y из N вакансий".

## [2025-11-23] - Пагинация списка вакансий на /vacancy
### Добавлено
- Реализована пагинация на клиентской странице `/vacancy` c подгрузкой по 50 вакансий на страницу.
- Подключён переиспользуемый компонент `Pagination` для переключения страниц, с сохранением текущих фильтров в query-параметрах.

### Изменено
- Клиентский запрос к `/api/jobs` теперь всегда передаёт `limit=50` и поддерживает query-параметр `page`.
- Логика отображения счётчика вакансий использует общее количество из ответа API (если доступно), а не только длину текущей страницы.

### Исправлено
- Исключена ситуация, когда при большом числе вакансий список загружался целиком без постраничной выборки.

## [2025-11-23] - Настройка абсолютных импортов
### Изменено
- В `tsconfig.json` добавлены `baseUrl: "."` и `paths: { "@/*": ["./*"] }` для поддержки абсолютных импортов.
- Обновлены импорты в `app/vakansii/[slug]/page.tsx` для использования алиаса `@/app/components/...` вместо относительных путей.

## [2025-11-23] - Удаление глобального meta keywords
### Изменено
- Глобальный meta-тег `keywords` удалён из `app/layout.tsx`; ключевые слова теперь задаются только на детальной странице вакансии `/vacancy/[id]` через `generateMetadata`.

## [2025-11-23] - UX пагинации на городских страницах
### Добавлено
- На странице `/vakansii/[slug]` добавлен текстовый индикатор диапазона «Показаны X–Y из N вакансий».
- Общий компонент пагинации `app/components/Pagination.tsx` дополнен плавным скроллом наверх при смене страницы, чтобы поведение совпадало со страницей `/vacancy`.

## [2025-11-23] - Компонент пагинации
### Добавлено
- Создан переиспользуемый компонент `app/components/Pagination.tsx` для навигации по страницам списков.
- Компонент поддерживает сохранение текущих query-параметров (фильтров) при переключении страниц.
- Интеграция компонента в страницу `app/vakansii/[slug]/page.tsx`.

## [2025-11-23] - SEO-метатеги keywords для вакансии
### Добавлено
- Реализована генерация мета-тега `keywords` для страницы вакансии (`app/vacancy/[id]/page.tsx`).
- Ключевые слова включают: «вакансия», «работа», название вакансии, название компании (при наличии) и город из адреса вакансии (`job.address.city`).

## [2025-11-23] - Исправление резервного хоста для SSR
### Исправлено
- Изменён резервный хост в `app/vacancy/[id]/page.tsx` с `localhost:3000` на `localhost:4000` для соответствия порту разработки (`next dev -p 4000`), чтобы избежать ошибок построения абсолютного URL при отсутствии заголовков.

## [2025-11-22] - SEO-метатеги вакансии (generateMetadata)
### Добавлено
- Зафиксирован шаблон формирования Title и Description страницы `app/vacancy/[id]/page.tsx`, зависящий от названия вакансии, города, зарплаты, названия компании и дат публикации/обновления.
- Обновлена архитектура с описанием источников данных (`salary_min`, `salary_max`, `company_profile.company_name`, `cities`, `address`, `posted_date`, `updated_at`, `work_experience`) и правил построения строк («до {salary_max}», «в {city}», «от {день месяц}»).

### Изменено
- План разработки дополнен задачей по внедрению шаблона SEO-метатегов для страницы вакансии.

### Исправлено
- ---

## [2025-11-23] - Фикс интерфейса JobPosting для детальной вакансии
### Добавлено
- Документировано приведение интерфейса `JobPosting` на `app/vacancy/[id]/page.tsx` к актуальной схеме ответа `GET /api/jobs/{job_id}` без дублирующихся полей.

### Изменено
- Из интерфейса `JobPosting` удалены повторные объявления полей `day_lengths`, `shift_types`, `work_schedule_types`, чтобы избежать конфликтов типов при сборке.

### Исправлено
- Устранены ошибки типизации, связанные с дублирующимися свойствами в интерфейсе `JobPosting` на странице детальной вакансии.

## [2025-11-22] - Предложный падеж города в метатегах вакансии
### Добавлено
- В swagger-документации поле `address.city_name_prepositional` описано как часть `controllers.JobAddress` для серверной карточки вакансии.

### Изменено
- Стратегия SEO-метатегов: `generateMetadata` и шаблон Description теперь используют `city_name_prepositional`, чтобы формулировки «в {городе}» были грамматически корректны.

### Исправлено
- Избегаются некорректные формы города в Title/Description, когда исходное название требует предложного падежа (пример: «в Ловцы» → «в Ловцах»).

## [2025-11-22] - Промо-редирект по внешней ссылке вакансии
### Добавлено
- Создана серверная страница `app/vacancy/[id]/to/page.tsx`, которая перенаправляет на внешнюю ссылку вакансии (`link`) при промо-размщении (`is_promo = true`).
- Кнопка «Откликнуться» на детальной странице вакансии, а также карточки в списке `/vakansii/[slug]` открывают новую вкладку с `/vacancy/[id]/to`, если вакансия промо.

### Изменено
- Документация (plan, architecture) дополнена схемой перехода через промежуточную страницу для безопасного отслеживания переходов на сторонние ресурсы. В списке `/vakansii/[slug]` кнопки «Откликнуться» на промо-позициях всегда ведут на `/vacancy/[id]/to`, независимо от наличия `link` в выдаче; на детальной странице проверка `link` остаётся обязательной.

### Исправлено
- ---

## [2025-11-22] - Текстовый блок опыта и формата работы (14px)
### Добавлено
- В план и архитектуру внесена правка по синхронизации размеров шрифта блока «Опыт работы/Формат работы» на странице `app/vacancy/[id]/page.tsx`, предусматривающая адаптивные классы по образцу блока зарплаты и отказ от `font-medium` для лейблов. Добавлен план расширения блока условиями («Тип графика работы», «График работы», «Часы работы», «Смены», «Занятость», «Образование»), а также унификация строки зарплаты: сумма, детали и «Выплаты» выводятся в одной строке, после деталей ставится точка, а сама подпись «Выплаты: …» начинается со строчной буквы.

### Изменено
- Запланировано увеличение базового размера шрифта блока «Опыт работы / Формат работы» с `13px` до адаптивных `text-sm md:text-base`, а лейблы больше не используют `font-medium`, чтобы визуально совпасть с блоком зарплаты. Уточнено, что блок дополняется динамическими строками по справочникам (графики, смены, занятость, образование) при наличии данных, а строка «Выплаты» снова выводится и учитывает русский и английский варианты значений `salary_frequency`.

### Исправлено
- ---

## [2025-11-22] - Структурированные данные JobPosting на странице вакансии
### Добавлено
- В план и архитектуру добавлена задача по внедрению JSON-LD `schema.org/JobPosting` на `app/vacancy/[id]/page.tsx` с поддержкой удалённых вакансий (`jobLocationType: "TELECOMMUTE"`).

### Изменено
- Архитектура дополнена описанием SEO-разметки: формирование `JobPosting` из данных API, ограничения на адрес (streetAddress, addressLocality, addressCountry) и логика удалённых форматов. Зафиксированы дополнительные требования SEO: исключение `identifier`, `hiringOrganization.logo/sameAs`, заполнение `datePosted` как «текущая дата - 1 день» и маппинг `employmentType` на значения `FULL_TIME`, `PART_TIME`, `CONTRACTOR`, `INTERN`, `VOLUNTEER` по справочнику занятостей.

### Исправлено
- ---

## [2025-11-21] - Деплой в /www/wwwroot/e77.top
## [2025-11-22] - HTML-рендер описания вакансии
### Добавлено
- Документирована задача по выводу HTML-разметки `JobPosting.description` на странице `app/vacancy/[id]/page.tsx`.

### Изменено
- План реализации и описание архитектуры детальной страницы вакансии дополнены информацией о безопасном рендере HTML вместо разбивки текста по строкам.

### Исправлено
- Уточнено, что HTML-контент проходит санитизацию на стороне бэкенда перед отображением на фронтенде.

## [2025-11-21] - Деплой в /www/wwwroot/e77.top
### Добавлено
- Документация по структуре развёртывания: основная рабочая копия фронтенда теперь хранится в `/www/wwwroot/e77.top`.

### Изменено
- Сценарий деплоя обновлён: сборка и зависимость `pm2` выполняются напрямую в каталоге `/www/wwwroot/e77.top`, чтобы исключить рассинхронизацию с резервным путём `/www/wwwroot/jobfind-fr`.

### Исправлено
- Удалён устаревший каталог `/www/wwwroot/jobfind-fr`, чтобы nginx и pm2 не могли подхватить старый билд после перезапуска.

## [2025-11-21] - Отключение кеша nginx для e77.top
### Добавлено
- Описание настройки nginx (aaPanel): файл `/www/server/nginx/conf/proxy.conf` больше не включает `proxy_cache` для e77.top, чтобы фронтенд всегда отдавал свежую сборку.

### Изменено
- Конфигурация nginx на сервере VPS: директивы `proxy_cache` из `proxy.conf` закомментированы, пока не появится потребность в CDN-кешировании.

### Исправлено
- Статическая отдача устаревшей версии сайта при остановленном Next.js-приложении (кеш nginx).

## [2025-11-21] - Автоочистка кеша nginx в деплое
### Добавлено
- Шаг деплоя в `.github/workflows/deploy.yml`, который очищает `/www/server/nginx/proxy_cache_dir/*` и выполняет `nginx -s reload` после перезапуска PM2.

### Исправлено
- Ситуация, когда после релиза nginx продолжал отдавать закешированный HTML, даже если приложение уже перезапущено.

## [2025-11-18] - SSR: абсолютный URL на /vacancy/[id] и SEO
### Добавлено
- Хелпер построения базового URL из заголовков (`x-forwarded-proto`, `x-forwarded-host`/`host`).

### Изменено
- `app/vacancy/[id]/page.tsx`: `fetch` в SSR и `generateMetadata` используют абсолютный URL, собранный из заголовков (`headers()`), вместо относительного.

### Исправлено
- Ошибка `Failed to parse URL from /api/jobs/{id}` в серверном окружении Next.js.

## [2025-11-18] - Блок «Работа в других городах» на главной
### Добавлено
- На главной странице добавлен нижний блок со списком 10 крупных городов РФ. Ссылки ведут на `/vacancy/{slug}`.

## [2025-11-18] - Страница списка по городу /vacancy/[slug]
### Добавлено
- Создана страница `/vacancy/[slug]` с отображением списка вакансий.
- Загрузка данных через `GET /api/jobs/searchBySlug?city_slug={slug}`.
- Вёрстка и карточки аналогичны странице `/vacancy`.

### Изменено
- Переведена страница `/vacancy/[slug]` на SSR (server component) с серверной загрузкой данных.
 - Маршрут для городов перенесён на `/vakansii/[slug]` для избежания конфликта с `/vacancy/[id]`. На главной странице ссылки обновлены на `/vakansii/{slug}`.
- Ссылки на главной заменены на `/vakansii/{slug}`.
- Старый маршрут `/vacancy/[slug]` удалён из роутинга (папка перемещена в `app/_deprecated/`).
 
### Исправлено
- На `/vakansii/[slug]` при SSR fetch теперь используется абсолютный URL, формируемый из заголовков запроса (`headers()`), что устраняет ошибку `Failed to parse URL` при относительном пути.
- На `/vakansii/[slug]` добавлена левая панель фильтров (компонент `JobFilters`) и обёртка раскладки как на `/vacancy`.
 - Исправлен `jobsApi.listCompanyJobs`: вместо `new URL()` (требует абсолютный URL) используется относительный путь с `URLSearchParams`, передаётся в `apiRequest` как строка.

## [2025-11-16] - CI/CD деплой на VPS (e77.top) через GitHub Actions
### Добавлено
- Workflow `.github/workflows/deploy.yml`: сборка на Node 18, архивирование артефактов, SCP на VPS, деплой в `/www/wwwroot/e77.top`, перезапуск `pm2` под именем `e77-top`. Переменные NEXT_PUBLIC_* не используются.

### Изменено
- Перевод фронтенд API на относительные пути (`API_BASE_URL = ''`) для работы через rewrite.
- Обновление `next.config.js`: rewrite `/api/:path* -> http://localhost:8081/api/:path*` через `afterFiles`.
 - Триггер workflow изменён на ветку `master`.

### Исправлено
- Исключены хардкоды `http://localhost:8080` в API-клиенте.

## [2025-11-15] - Просмотр резюме: клиентский редирект при отсутствии токена
### Добавлено
- 

### Изменено
- Уточнена документация по странице `app/resume/[id]/page.tsx`: вход защищён проверкой токена на клиенте с использованием `useRouter`.

### Исправлено
- Сборка больше не падает из-за отсутствующего `router` при обращении к `router.push('/login')` в `app/resume/[id]/page.tsx` — используем хук `useRouter` и корректные проверки.

## [2025-11-15] - Редактирование резюме: обработчик должности
### Добавлено
- 

### Изменено
- Документация о поведении поля «Желаемая должность» обновлена с учётом автодополнения и обязательного обработчика изменения значения.

### Исправлено
- При редактировании резюме на странице `app/resume/[id]/edit/page.tsx` будет добавлен обработчик `handleTitleChange`, чтобы устранить ошибку типизации при сборке.

## [2025-11-15] - Фикс загрузки логотипа компании
### Добавлено
- 

### Изменено
- Актуализирована документация по форме профиля компании с описанием структуры объекта `logo` в состоянии.

### Исправлено
- При загрузке логотипа на странице `app/employer/addcompany/page.tsx` теперь всегда заполняется свойство `logo.url`, что устраняет ошибку типизации при сборке.

## [2025-11-15] - Устранение ошибок сборки (useSearchParams и конфигурация Next.js)
### Добавлено
- План обновления клиентских страниц `/profile`, `/employer/mycompany`, `/vacancy` с внедрением `<Suspense>` и выносом логики `useSearchParams` в отдельные компоненты для корректной работы при статической генерации.

### Изменено
- Документация (plan, architecture) дополнена описанием требований к клиентским компонентам, использующим `useSearchParams`, и уточнена стратегия конфигурации Next.js без устаревшего ключа `experimental.telemetry`.
- Принято решение оставить `/vacancy` полностью клиентской: вынесена логика в `VacancyClient` и добавлен серверный `page.tsx` с `<Suspense>` для корректного prerender.

### Исправлено
- Удалён невалидный ключ `telemetry` в `next.config.js`. Подготовлены правки для устранения падений `next build`, связанных с отсутствием `<Suspense>` вокруг `useSearchParams`.

## [2025-11-10] - Детальная страница вакансии /vacancy/[id] (SSR)
### Добавлено
- Страница `/vacancy/[id]` как серверный компонент (SSR) с загрузкой `GET /api/jobs/{job_id}`.
- Хлебные крошки в верхней части страницы по образцу макета.
- Панель действий с кнопкой «Откликнуться» (заглушка без логики), а также базовые кнопки избранного/жалобы (заглушки).
 - Skeleton загрузки `app/vacancy/[id]/loading.tsx` для клиентских переходов.
 - SEO: `generateMetadata` с формированием заголовка по названию вакансии и городу.

### Изменено
- Визуальные правки под макет: увеличенный заголовок, отступы, спокойные вторичные тексты, оформление блоков «Условия»/«Обязанности», единые радиусы и тени.

### Исправлено
- Обработка 404 (Not Found) через `notFound()` при отсутствии вакансии.

## [2025-11-10] - Редизайн UI детальной страницы вакансии
### Добавлено
- Выпадающее меню действий ("В черный список", "Пожаловаться") в панели действий.

### Изменено
- Объединены информационные блоки (заголовок/зарплата/лейблы/адрес, информация о компании, условия, описание) в один визуальный контейнер.
- Панель действий переведена на `position: sticky` внутри прокручиваемого контейнера (липнет к низу видимой области контента).
- Кнопка «В избранное» заменена на иконку сердечка.

### Исправлено
- Панель больше не перекрывает контент и не требует дополнительного нижнего паддинга у страницы.

## [2025-11-09] - Список вакансий /vacancy под новый GET /api/jobs (Вариант B)
### Добавлено
- Отображение карточек вакансий по схеме `controllers.JobListItem` (`job_id`, `company_name`, `logo_url`, `title`, `work_experience`, `salary_*`, `address`, `publication_cities`, `work_format_ids`).
- Ссылка по названию вакансии на `/vacancy/[job_id]`.
- Блок зарплаты с форматированием диапазона/от/до, периодом (`salary_period`) и типом налогообложения (`salary_type`).
- Чипы формата работы по `work_format_ids` (маппинг из `app/config/work_formats_202505222228.json`).
- Выбор города (Вариант B): приоритет `address.city`, затем первый из `publication_cities`, совпадающий с выбранными в фильтрах городами (имена получены по `city_id` через справочник), иначе первый из `publication_cities`.
- Справа в карточке: логотип компании и кнопка «Откликнуться».

### Изменено
- Адаптивная верстка карточки для мобайла и десктопа.

### Исправлено
- Устранён устаревший рендер под старую структуру (`experience_level`, `employment_type`, `work_format`).

## [2025-11-09] - Карточка вакансии: отдельная строка для города и адреса
### Изменено
- Перенесён вывод города из чипа в отдельную строку под чипами.
- Формат: `Город, адрес` при наличии полей `address.city` и `address.address`; если `address` отсутствует, используется город из логики Варианта B.
### Добавлено
- Добавлена иконка локации перед строкой адреса.

## [2025-11-09] - Диагностика /api/jobs (500 и прокси на :3000)
### Добавлено
- Задача в `docs/plan.md` по диагностике проблемы запросов `/api/jobs` и неверного проксирования на `localhost:3000` при бэкенде на `localhost:8080`.

### Изменено
- Проведён анализ `next.config.js` (rewrites `/api/*` → `http://localhost:3000/api/*`), `middleware.ts` (без влияния на /api), `app/vacancy/page.tsx` (относительный fetch `/api/jobs`).
- Подготовлено изменение стратегии переписываний: использовать `afterFiles` для проксирования `/api/*` на `http://localhost:8080`, чтобы локальные руты `app/api/*` (например, `/api/upload`) обрабатывались самим Next.

## [2025-11-08] - Редактирование вакансии: предзаполнение «Часов в день», «Регион», «Профессия»
### Изменено
- В `app/employer/vacancies/page.tsx` при загрузке полной карточки вакансии (`GET /api/companies/jobs/{id}`) добавлено предзаполнение:
  - `dayLengthIds` из `day_length_ids` или `day_lengths[{ day_length_id }]` (также сохранена поддержка `work_day_lengths`)
  - `regionIds` и видимого ввода региона из `region_ids` или `regions[{ region_id, name }]`
  - `professionInput` из `profession.name` (помимо `profession_id`)

## [2025-11-09] - Обязательность города в UI, Вариант A
### Изменено
- Swagger не изменён: обязательные поля для `/api/jobs` POST и `/api/jobs/{job_id}` PUT остаются `title`, `description`, `work_experience`.
- В `app/employer/vacancies/page.tsx` добавлена обязательность выбора города публикации на уровне UI: требуется хотя бы один город (`publicationCityIds`) или установленный `publication_city_id`.

### Исправлено
- Валидация формы теперь показывает ошибку под блоком городов при отсутствии выбранных городов и блокирует отправку.

## [2025-11-08] - Вакансии компании: корректные эндпоинты списка и детали
### Изменено
- Список вакансий компании получается через `GET /api/companies/jobs`.
- При открытии модального окна редактирования полная карточка вакансии загружается через `GET /api/companies/jobs/{id}` согласно swagger.

## [2025-11-08] - Редактирование вакансии: предзаполнение мультивыборов
### Изменено
- В `app/employer/vacancies/page.tsx` в `startEdit` добавлена инициализация массивов ID для мультивыборов из данных вакансии: `employment_type_ids`, `education_type_ids`, `work_format_ids`, `work_schedule_type_ids`, `work_schedule_ids`, `day_length_ids`, `shift_type_ids`. Поддержаны форматы API: как массивы идентификаторов, так и массивы сущностей.

### Исправлено
- При редактировании вакансии поля мультивыборов отображаются пустыми, даже если в вакансии есть связанные значения.

## [2025-11-08] - Хедер переведён на sticky и устранено перекрытие контента
### Изменено
- В `app/components/Header.tsx` заменён `fixed` на `sticky` с `top-0 z-50`, чтобы хедер оставался видимым при прокрутке и не перекрывал контент страниц (включая раздел `/employer/*`).

### Исправлено
- Перекрытие контента страниц верхним меню из-за фиксированного позиционирования.

## [2025-11-05] - Исправление ошибки хуков на странице вакансий работодателя
### Исправлено
- Перемещён ранний возврат `return null` после инициализации всех хуков в `app/employer/vacancies/page.tsx`, чтобы избежать ошибки `Rendered more hooks than during the previous render`.

## [2025-11-05] - Ограничение доступа к странице вакансий работодателя
### Добавлено
- Клиентская проверка роли на `app/employer/vacancies/page.tsx`: при `localStorage.user_type !== 'employer'` выполняется `router.replace('/login')`.

## [2025-10-28] - Синхронизация типов ID с docs/swagger
### Добавлено
- 

### Изменено
- Приведены типы идентификаторов к строкам (UUID) согласно обновлению swagger:
  - controllers.LoginResponse.user.user_id → string (UUID)
  - models.JobPosting.posted_by → string
  - models.CompanyEmployee.user_id → string
  - models.CompanyProfile.user_id → string
  - (В swagger также обновлены: models.ChatMessage.sender_id, models.ChatParticipant.user_id, models.JobApplication.applicant_id, models.JobSeekerProfile.user_id, models.User.user_id → string) 

### Исправлено
- 

## [2025-11-22] - Визуальный редактор описания вакансии работодателя
### Добавлено
- Задача по замене текстового поля описания вакансии работодателя на визуальный редактор (react-quill) с очисткой HTML через DOMPurify перед сохранением.

### Изменено
- Документация по форме вакансии работодателя и описанию вакансии обновлена с учётом хранения отформатированного HTML без гиперссылок.
- Поле описания вакансии стало ресайзируемым: добавлены CSS-правки для поддержания `resize-y` и минимальной высоты редактора.

### Исправлено
- Снижены риски XSS при отображении описания вакансии за счёт явной санитизации HTML-контента на клиенте перед отправкой и рекомендаций по санитизации на бэкенде.
- Добавлено подключение темы `quill.snow.css`, чтобы исправить артефакты отображения тулбара и области редактирования.

## [2025-10-30] - Централизация загрузки фото резюме
### Добавлено
- Поддержка параметра `folder` в API-роуте `/api/upload` с белым списком (`companyLogo`, `photo`)
- Возврат `fileName` в ответе `/api/upload` (имя сохранённого файла без пути)
- Расширение клиентской функции `uploadFile(file, folder?)` в `app/utils/api.ts`

### Изменено
- `app/resume/add/page.tsx`: загрузка фото через `/api/upload` в `uploads/photo`, при создании резюме на бэкенд отправляется только имя файла в поле `photo_url`
- `app/resume/[id]/page.tsx`: обновление фото через `/api/upload` в `uploads/photo`, на бэкенд отправляется только имя файла в поле `photo_url`
- `app/resume/[id]/edit/page.tsx`: редактирование резюме использует ту же схему — фото загружается через `/api/upload` в `uploads/photo`, на бэкенд отправляется только имя файла `photo_url`

## [2025-10-30] - Форма вакансии: адрес компании
### Изменено
- `app/employer/vacancies/page.tsx`: поле «Адрес компании» заменено на одиночный выпадающий список с данными из `/api/companies/profile` (GET). В запрос вакансии отправляется `company_address_id` (число), контракт бэкенда не менялся.

## [2025-10-31] - Форма вакансии: автокомплит профессии
### Добавлено
- `app/employer/vacancies/page.tsx`: автокомплит поля «Профессия» с использованием `/api/dictionaries/professions/search` (GET). При выборе устанавливается `profession_id`.

## [2025-10-31] - Форма вакансии: города публикации и регионы
### Добавлено
- `app/employer/vacancies/page.tsx`: вынесены отдельные блоки
  - «Города публикации» — мультивыбор до 10, поиск по `/api/locations/cities/search`, отправка `city_ids`.
  - «Регионы» — мультивыбор до 10, отправка `region_ids`.

## [2025-10-31] - Форма вакансии: единый UX мультивыборов
### Изменено
- `app/employer/vacancies/page.tsx`: замена нативных `<select multiple>` на выпадающие мультисписки с чекбоксами для полей:
  - Тип занятости (`employment_type_ids`)
  - Уровень образования (`education_type_ids`)
  - Формат работы (`work_format_ids`)
  - График работы (`work_schedule_type_ids`)
  - Расписание (`work_schedule_ids`)
  - Часов в день (`day_length_ids`)
  - Смены (`shift_type_ids`)

## [2025-10-31] - Форма вакансии: валидация и строгий payload
### Добавлено
- Подсветка ошибок по блокам: название, описание, профессия, адрес компании, зарплата (min/max), города публикации (лимит 10), регионы (лимит 10).
- Деактивация кнопок «Создать/Сохранить» при критических ошибках.
- Строгий тип payload для submitCreate/submitEdit согласно примеру: `company_address_id`, `profession_id`, `title`, `description`, массивы `*_ids`, `city_ids`, `region_ids`, `salary_*` и прочие поля.

## [2025-11-02] - Форма вакансии: исправление адресов API
### Исправлено
- `app/employer/vacancies/page.tsx`: запросы переведены на `API_ENDPOINTS` (порт 8080):
  - Поиск профессий → `API_ENDPOINTS.dictionaries.professionsSearch`
  - Поиск городов → `API_ENDPOINTS.citiesSearch`
  - Профиль компании → `API_ENDPOINTS.companies.profile`

## [2025-11-02] - Форма вакансии: UX выбора городов
### Изменено
- `app/employer/vacancies/page.tsx`: для «Города публикации» добавлен отдельный горизонтальный блок с выбранными городами (чипы) и иконкой удаления; список опций скрывается сразу после выбора города. Реализовано закрытие дропдауна по клику вне области и запрет повторного открытия во время активного поиска.

## [2025-11-02] - Форма вакансии: UX выбора региона
### Изменено
- `app/employer/vacancies/page.tsx`: дропдаун «Регион» закрывается по клику вне области. Источник данных — `/api/locations` (GET) с фильтрацией элементов `type: 'reg'`.

## [2025-11-02] - Форма вакансии: UX поля «Профессия»
### Изменено
- `app/employer/vacancies/page.tsx`: в поле «Профессия» добавлена кнопка очистки ✕, которая снимает выбор и очищает ошибку; дропдаун закрывается по клику вне области.

## [2025-11-02] - Форма вакансии: выпадающие списки зарплаты
### Изменено
- `app/employer/vacancies/page.tsx`: поля «Частота выплаты», «Период зарплаты», «Тип зарплаты» заменены на выпадающие списки. В UI отображаются RU-лейблы, в payload отправляются EN-значения (enum).

## [2025-11-02] - Форма вакансии: закрытие выпадающих списков
### Изменено
- `app/employer/vacancies/page.tsx`: реализовано закрытие по клику вне области для: «Адрес компании», «Частота выплаты», «Период зарплаты», «Тип зарплаты», а также мультивыпадающих списков: «Тип занятости», «Уровень образования», «Формат работы», «График работы», «Расписание», «Часов в день», «Смены».

## [2025-11-02] - Форма вакансии: поле «Опыт работы»
### Добавлено
- `app/employer/vacancies/page.tsx`: добавлено обязательное поле «Опыт работы» (`work_experience`) как одиночный выпадающий список с закрытием по клику вне области. В UI отображаются RU-лейблы, в payload отправляются EN-значения.

### Исправлено
- Исключено прямое отправление бинарного файла фото в эндпоинты резюме

## [2025-10-28] - Форма вакансии: скролл и мультиселекты
### Добавлено
- Скролл содержимого модального окна на `app/employer/vacancies/page.tsx` (ограничение высоты и `overflow-y-auto`)
- Множественные выпадающие списки для полей: Тип занятости, Уровень опыта, Формат работы, График работы, Часов в день, Смены
- Справочники из БД выгружены через MCP и сохранены в `app/config/`: `work_schedules_20251028.json`, `work_schedule_types_20251028.json`, `work_day_lengths_20251028.json`, `shift_types_20251028.json`

### Изменено
- Поля формы вакансии приведены к использованию локальных справочников вместо текстового ввода

### Исправлено
- Удалены поля «Дата окончания публикации» и «Опыт работы (текст)» из формы создания/редактирования вакансии

## [2025-10-28] - Payload вакансии по swagger (controllers.JobUpsertRequest)
### Добавлено
- Реализован маппинг формы в формат бекэнда: массивы `employment_type_ids`, `education_type_ids`, `work_format_ids`, `work_schedule_type_ids`, `work_schedule_ids`, `day_length_ids`, `shift_type_ids`, `city_ids`, `region_ids`
- Добавлен мультиселект расписаний `work_schedules` (5/2, 6/1 и др.)

### Изменено
- `submitCreate`/`submitEdit` отправляют только поля, ожидаемые бекэндом (без устаревших строковых полей)

## [2025-10-28] - Валидация формы вакансии и подсказки
### Добавлено
- Клиентская валидация обязательных полей: `title`, `description`, `profession_id`, `company_address_id`; проверка `salary_min <= salary_max`
- Отображение ошибок под соответствующими полями и общее предупреждение в форме
- Подсказки под мультиселектами: "Можно выбрать несколько. Оставьте пустым, если неважно."

## [2025-10-29] - Исправление ошибки в CityAutocomplete
### Изменено
- `CityAutocomplete` обращается к `/api/locations/cities/search` вместо устаревшего `/api/locations`

### Исправлено
- Корректное использование справочного эндпоинта из `swagger.yaml`
- Исправлена ошибка "Cannot read properties of undefined (reading 'toString')" при выборе города
- Добавлена обработка случаев, когда API возвращает `city.id` вместо `city.city_id`
- Добавлена фильтрация невалидных данных от API (города без city_id или name)
- Добавлена строгая проверка типов в handleSuggestionClick
- Обновлен интерфейс City для корректного отражения типов данных

## [2025-10-26] - Форма компании: адреса и отрасли
### Добавлено
- Поля формы для создания компании с поддержкой 1+ адресов (город + адрес)
- Мультивыбор отраслей с маппингом к формату API (industries: [{ industry_id }])

### Изменено
- Payload отправки на /api/companies/profile приведён к models.CompanyProfile (website_url, logo_url, company_size, is_it_company, email, brand_name, industries[], addresses[])
- Временно исключено поле district_id из формы и из payload адресов
- `CityAutocomplete` теперь использует бекэнд на 8080 через `API_ENDPOINTS.locations` (без обращения к 3000)
 - Добавлен завершающий слэш к `API_ENDPOINTS.locations` для избежания 301 redirect
 - Удалён префикс `https://example.com/` у `logo_url`; теперь отправляется только путь к файлу
 - Серверная загрузка файлов настроена на каталог `public/uploads/companyLogo` и возвращает путь `/uploads/companyLogo/<file>`

### Исправлено
- 

## [2025-10-24] - Приведение формы вакансии к models.JobPosting
### Добавлено
- Полный набор полей в форме создания/редактирования вакансии согласно docs/swagger.yaml (models.JobPosting)

### Изменено
- Обновлены типы JobPosting в app/utils/api.ts, payload для create/update
- Поля salary_from/to заменены на salary_min/max, status на is_active

### Исправлено
- 

## [2025-10-24] - Улучшение UX создания вакансии
### Добавлено
- Кнопка добавления вакансии в пустом состоянии списка на /employer/vacancies
- Плавающая кнопка (FAB) создания вакансии для мобильных экранов

### Изменено
- Улучшена доступность действия создания вакансии

### Исправлено
-

## [2025-10-24] - Исправление списка вакансий работодателя
### Добавлено
- Нормализация ответа API для /api/companies/jobs (поддержка форматов data/items/job_postings)

### Изменено
- Защита UI от не-массивов при рендеринге списка (исправлена ошибка filtered.map is not a function)

### Исправлено
- Ошибка рантайма на странице /employer/vacancies

## [2025-10-24] - Страница вакансий работодателя и CRUD
### Добавлено
- Страница /employer/vacancies со списком вакансий компании (CRUD: просмотр/добавление/изменение/удаление)
- Базовые формы добавления и редактирования вакансий

### Изменено
- API-клиент: добавлены endpoints companiesJobs, jobById, createJob, updateJob, deleteJob

### Исправлено
-

## [2025-10-24] - Обновление ссылок навигации
### Добавлено
- 

### Изменено
- Ссылка "Моя компания" в Header ведет на /employer/mycompany

### Исправлено
-

## [2025-11-20] - Деплой на VPS: PM2 и каталог uploads
### Добавлено
- Автоматическое создание каталога `public/uploads/companyLogo` на сервере в процессе деплоя.

### Изменено
- `.github/workflows/deploy.yml`: процесс PM2 `e77-top` перезапускается с указанием `--cwd /www/wwwroot/e77.top` через `pm2 delete` + `pm2 start npm ...`, что гарантирует использование свежей версии кода из целевого каталога.

### Исправлено
- После деплоя новая версия фронтенда корректно перезапускается из каталога `/www/wwwroot/e77.top`, а отсутствие каталога `public/uploads` больше не ломает загрузку файлов.

## [2025-11-20] - Форма вакансии работодателя: адрес компании не обязателен
### Добавлено
- Подпись поля адреса компании в форме вакансии обновлена на "Адрес компании (необязательно)", чтобы явно отразить новый бизнес-требование.

### Изменено
- `app/employer/vacancies/page.tsx`: текст label для поля выбора адреса компании.

### Исправлено
- Несоответствие между фактической валидацией (адрес опционален) и текстом UI.

### Добавлено
- Описание изменения требований к полю адреса компании в форме создания/редактирования вакансий работодателя.

### Изменено
- `app/employer/vacancies/page.tsx`: поле `company_address_id` больше не участвует в критической валидации (`hasCriticalErrors`) и не помечается как обязательное в функции `validate()`.

### Исправлено
- Кнопка создания/сохранения вакансии больше не блокируется, если адрес компании не выбран, при условии корректного заполнения остальных обязательных полей.

## [2025-11-20] - Обработка ошибок загрузки вакансий работодателя
### Добавлено
- План и реализация обработки ошибок в функции загрузки списка вакансий работодателя на странице `/employer/vacancies`.

### Изменено
- `app/employer/vacancies/page.tsx`: функция `load()` обёрнута в `try/catch/finally`, чтобы гарантировать сброс `loading` и установку понятного сообщения об ошибке при недоступности бэкенда (`/api/companies/jobs`).

### Исправлено
- Состояние `loading` больше не «зависает» в `true` при ошибке запроса, из-за чего кнопка «Создать» на форме вакансии всегда была задизейблена.

## [2025-11-19] - Добавление фавиконок и SEO для E77.top
### Добавлено
- Две фавиконки `/favicon-48x48.ico` и `/favicon-120x120.png` в корне `public`.
- Подключение фавиконок через `metadata.icons` в `app/layout.tsx`.
- Подключение фавиконок через `<Head>` в клиентском лейауте `app/client-layout.tsx`.
- SEO-метаданные для страницы списка вакансий по городу `/vakansii/[slug]` с использованием `name_prepositional` из `/api/dictionaries/cities/by-slug/{slug}`.

### Изменено
- Обновлён корневой `metadata` в `app/layout.tsx` под бренд E77.top.

### Исправлено
- 

## [2025-01-29] - Создание описания архитектуры платформы JobFind
### Добавлено
- Полное описание архитектуры платформы поиска работы
- Диаграммы архитектуры в формате Mermaid
- Структура базы данных с ER-диаграммой
- Описание взаимодействия компонентов системы
- Стратегии безопасности, производительности и масштабирования

## [2025-01-29] - Корректировка архитектуры под текущее состояние проекта
### Изменено
- Актуализировано описание архитектуры под текущую реализацию (только фронтенд)
- Убраны детали Go бэкенда и PostgreSQL, так как они не реализованы
- Добавлено описание текущих компонентов Next.js приложения
- Обновлена диаграмма архитектуры для отражения текущего состояния
- Добавлен раздел планируемого развития с описанием будущих компонентов

## [2025-01-29] - Создание плана реализации проекта
### Добавлено
- Детальный план разработки в /docs/plan.md
- Основные задачи проекта с разбивкой на этапы
- Шаги выполнения для каждой задачи с чекбоксами
- Зависимости между задачами
- Приоритизация задач согласно текущему состоянию проекта

## [2025-01-29] - Обновление дизайна интерфейса
### Изменено
- Полностью обновлен дизайн Header.tsx с современным стилем
- Добавлен логотип JobFind с градиентным дизайном
- Улучшена навигация для разных типов пользователей
- Добавлено мобильное меню для адаптивности
- Обновлена главная страница page.tsx с современным дизайном
- Добавлены секции со статистикой и преимуществами платформы
- Улучшена поисковая форма с популярными запросами
- Исправлены синтаксические ошибки в коде хедера

## [2025-10-27] - Приведение формы вакансии к структуре БД
### Добавлено
- Запланированы поля формы для связей: vacancy_day_lengths, vacancy_employment_types, vacancy_cities, vacancy_education_types, vacancy_regions, vacancy_shift_types, vacancy_work_formats, vacancy_work_schedule_types, vacancy_work_schedules
- Инициация получения значений enum из БД через MCP для: experience_level, work_experience, salary_type, salary_period, salary_frequency

### Изменено
- План обновлён: выравнивание `app/employer/vacancies/page.tsx` и типов с таблицей `job_postings` (добавлен `publish_in_all_cities`, обязательность `description`, `profession_id`, `company_address_id`, `work_experience`)

### Исправлено
- 

## [2025-10-27] - Автокомплит городов и регионов на странице вакансий
### Добавлено
- Автокомплит для поля города публикации (CityAutocomplete) на `app/employer/vacancies/page.tsx`
- Новый компонент `app/components/RegionAutocomplete.tsx` для подбора регионов через `/api/locations?query=`

### Изменено
- Поле "Город публикации (ID)" заменено на ввод с автодополнением и установкой `publication_city_id`

### Исправлено
- 
